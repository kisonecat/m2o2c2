\documentclass{ximera}
\title{The gradient}

\begin{document}

\begin{abstract}
  The gradient is a vector version of the derivative.
\end{abstract}

In this section, we will focus on gaining a more "geometric" understanding of derivatives of functions $f:\R^n \to \R$.

If $f$ is such a function, the derivative $Df\left(\mathbf{p}\right) :\R^n \to \R$ is a covector.  So, by the definition of the dot product,
 we can reinterpret that derivative as the dot product with the fixed vector $Df\left(\mathbf{p}\right)^\top$.
 
 \begin{definition}
 	The gradient of a differentiable function $f:\R^n \to \R$ is defined by $\nabla f (\mathbf{p})= Df\left(\mathbf{p}\right)^\top$.
 	Equivalently, $\nabla f$ is the (unique) vector which makes the following equation true for all $\vec{v} \in \R^n$:
 	
 	\[ \nabla f(\mathbf{p}) \cdot v = Df(\mathbf{p})(v)\] 
 \end{definition}
 
 \begin{question}
 	\begin{solution}
 		\begin{hint}
 			$\nabla f(x,y,z) = \verticalvector{\frac{\partial}{\partial x} sin(xyz^2) \\ \frac{\partial}{\partial y} sin(xyz^2) \\\frac{\partial}{\partial z} sin(xyz^2) }$
 		\end{hint}
 		\begin{hint}
 			$\nabla f(x,y,z) = \verticalvector{yz^2\cos(xyz^2)\\ xz^2\cos(xyz^2)\\ 2xyz\cos(xyz^2)}$
 		\end{hint}
 	If $f:\R^3 \to \R$ is defined by $f(x,y,z) = sin(xyz^2)$, what is $\nabla f(x,y,z)$?
 		\begin{matrix-answer}
 			correctMatrix = [['yz^2cos(xyz^2)'],['xz^2cos(xyz^2)'],['2xyzcos(xyz^2)']]
 		\end{matrix-answer}
 	\end{solution}
 \end{question}
 
 We can now use what we know about the geometry of the dot product to understand some interesting things about the derivative.

 In a sentence, how does the vector $\frac{\vec{v}}{|\vec{v}|}$ relate to the vector $\vec{v}$?
 
 \begin{free-response}
 	$\frac{\vec{v}}{|\vec{v}|}$ is the unit vector which points in the same direction as $\vec{v}$
 \end{free-response}	
 
 \begin{theorem}
 	Let $f:\R^n \to \R$, and $\mathbf{p} \in R^n$.   Let $\nu = \frac{\nabla f(\mathbf{p})}{\left|\nabla f (p)\right|}$
 	
 	If $\left|\vec{v}\right| = 1$, then $Df(\mathbf{p})(\vec{v}) \leq Df(\mathbf{p})( \nu )$
 \end{theorem}

	More geometrically, this theorem says that $\nabla f(\mathbf{p})$ points in the direction of  ``greatest increase'' for the function $f$.
	More poetically, $\nabla f$ always points ``straight up the mountain''.
	

	Prove this theorem.
	
	\begin{free-response}
		 
		 \begin{align*}
		 	Df(\mathbf{p})(\vec{v}) &= \nabla f (\mathbf{p}) \cdot \vec{v}\\
		 		&\leq |\vec{v}||\nabla f(\mathbf{p})| \text{ by Cauchy-Schwarz}\\
		 		&= |\nabla f(\mathbf{p})| \text{ since $|\vec{v}|=1$}
		 \end{align*}
		 
		 On the other hand, 
		 
		 \begin{align*}
		 	Df\big|_{\mathbf{p}}(\vec{\nu}) &= \nabla f (\mathbf{p}) \cdot \vec{\nu}\\
		 		&= \nabla f (\mathbf{p}) \cdot  \frac{\nabla f(\mathbf{p})}{\left|\nabla f (\mathbf{p})\right|}\\
		 		&= \frac{\left| \nabla f(\mathbf{p})\right|^2}{\left| \nabla f(\mathbf{p})\right|}\\
		 		&= \left| \nabla f (\mathbf{p})\right|
		 			 \end{align*}
		 			 
		  The inequality follows.
	\end{free-response}
	
	

One of the ways that we learned to visualize functions was via contour plots.  We will see that there is a very nice relationship between contours and gradient vectors.

Let's start with the two dimensional case.  Let $f: \R^2 \to \R$, and consider the contour $\mathcal{C} = \{ (x,y) \in \R^2 :  f(x,y) = c \}$ for some $c \in \R$.

%BADBAD PICTURE

\begin{question}
	Let $\vec{v}$ be a tangent vector to $\mathcal{C}$ at a point $\mathbf{p} \in \mathcal{C}$ 
	\begin{solution}
		\begin{hint}
			Since $\vec{v}$ is pointing in the direction of a level curve of $f$, $f$ should not be changing as you move in the direction $\vec{v}$
		\end{hint}
		\begin{hint}
			So $Df(\mathbf{p})(\vec{v}) = 0$.
		\end{hint}
		$Df(\mathbf{p})(\vec{v}) = $ \answer{$0$}
		
		Note:  You should be able to answer this from an intuitive point of view, but we will not develop the formal tool to prove this 
	(the \href{http://en.wikipedia.org/wiki/Implicit_function_theorem}{implicit function theorem}) in this course.
	\end{solution}
	
	
\end{question}

In general, if $f:\R^n \to \R$, and the contour $\mathcal{C} = \{ \mathbf{p} \in \R^n :  f(\mathbf{p}) = c \}$ for some $c \in \R$, then for every tangent 
vector $\vec{v}$ to $\mathcal{C}$, we will have $Df{\mathbf{p}}{\vec{v}}  =0$.  
Intuitively this is true because moving a small amount in the direction of $\vec{v}$ will not change the value of the function much,
 since you are staying as close as possible to the contour where the function is constant.  Accepting this, we have the following:
 
 \begin{theorem}
  	If $f:\R^n \to \R$, and the contour $\mathcal{C} = \{ \mathbf{p} \in \R^n :  f(\mathbf{p}) = c \}$ for some $c \in \R$, then for every tangent 
vector $\vec{v}$ to $\mathcal{C}$, we will have $\nabla f(\mathbf{p}) \cdot v  =0$.  In other words, $\nabla f(\mathbf{p})$ is perpendicular to the 
contour.
 \end{theorem}
 
 %\begin{question}
 %BADBAD interactive:
 %	Given contour plot, draw in a possible gradient vector at specified point
 %\end{question}
 
% \begin{question}
 %BADBAD multiple choice:
 %	Given contour plot, which of the following is the gradient vector field?
 %\end{question}

\begin{question}
	Write an equation for the tangent plane to the surface $x^2+xy+4z^2 = 1$ at the point $(1,0,0)$.
		\begin{solution}
			\begin{hint}
				Our general strategy will be to find a vector which is perpendicular to the plane.  Writing down what that means in terms of dot products should
				yield the equation.
			\end{hint}
			\begin{hint}
				This surface is a level surface of $f(x,y,z) = x^2+xy+4z^2$, namely $f(x,y,z) = 1$.
			\end{hint}
			\begin{hint}
				$\nabla f  = \verticalvector{\frac{\partial f}{\partial x} \\ \frac{\partial f}{\partial y} \\ \frac{\partial f}{\partial z}}$
			\end{hint}
			\begin{hint}
				$\nabla f  =\verticalvector{ 2x+y\\x\\8z}$
			\end{hint}
			\begin{hint}
				$\nabla f (1,0,0) = \verticalvector{1\\1\\0} $
			\end{hint}
			\begin{hint}
				For a point $(x,y,z)$ to be in the tangent plane, we would need that $(x,y,z) - (1,0,0)$ is perpendicular to $\nabla f (1,0,0)$.
			\end{hint}
			\begin{hint}
				So we need $\verticalvector{x-1\\y\\z} \cdot \verticalvector{1\\1\\0} = 0$
			\end{hint}
			\begin{hint}
				This says that the equation of the plane is $x-1+y=0$
			\end{hint}
			\answer{$x+y-1$} $= 0$
		\end{solution}
\end{question}




\end{document}